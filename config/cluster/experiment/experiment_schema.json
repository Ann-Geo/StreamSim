{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Experiment",
  "type": "object",
  "description": "Drive specific configs",
  "properties": {
    "role": {
      "type": "string",
      "enum": ["producer", "consumer", "coordinator"],
      "description": "Role of the experiment (producer or consumer or coordinator)"
    },
    "numPhases": {
      "type": "array",
      "items": {
        "type": "integer",
        "minimum": 1
      },
      "description": "Array of phase counts (each representing a phase identifier or duration value)"
    },
    "concurrency": {
      "type": "integer",
      "minimum": 0,
      "description": "Producer/consumer concurrency separation in minutes"
    },
    "testType": {
      "type": "string",
      "enum": ["latency", "throughput", "non-test"],
      "description": "Type of test to be performed"
    },
    "testPattern": {
      "type": "string",
      "enum": ["work-sharing", "work-sharing-fb", "broadcast", "broadcast-gather"],
      "description": "Pattern of test to be performed"
    },
    "duration": {
      "type": "integer",
      "minimum": 1,
      "description": "Duration of the experiment in minutes"
    },
    "msgCount": {
      "type": "integer",
      "minimum": 1,
      "description": "Number of messages to send if using count-based experiment"
    },
    "testMode": {
      "type": "string",
      "enum": ["msgCount", "duration"],
      "description": "Whether the experiment runs for a fixed count or fixed duration"
    }
  },
  "required": ["role", "testType", "testPattern", "testMode"],
  "oneOf": [
    {
      "required": ["testMode", "msgCount"],
      "properties": {
        "testMode": { "const": "msgCount" }
      }
    },
    {
      "required": ["testMode", "duration"],
      "properties": {
        "testMode": { "const": "duration" }
      }
    }
  ]
}
